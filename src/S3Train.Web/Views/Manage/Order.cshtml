@using S3Train.Web.Models;
@using Microsoft.AspNet.Identity;
@model HomeViewModel
@{
    /**/

    ViewBag.Title = "Purchase";
    Layout = "~/Views/Shared/_Profile.cshtml";
    var ApplicationUserId = User.Identity.GetUserId();
}

@if (Model.OrderProViewModel == null || Model.OrderProViewModel.Count == 0)
{
    <div class="cart-empty">
        <p>No purchase orders yet</p>
        <a class="continue" href="@Url.Action("Index", "Home", null)">Buy Now</a>
    </div>
}
else
{

        <h2 class="text-danger">My purchase order</h2>
        <hr />
        <table class="table table-bordered">
            <tr>
                <th>
                    Order#
                </th>
                <th>
                    Date of purchase
                </th>
                <th>
                    Receiver
                </th>
                <th>
                    Total money
                </th>
                <th>
                    Status
                </th>
                <th>
                    Note
                </th>
                <th></th>
            </tr>

            @foreach (var item in Model.OrderProViewModel)
            {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.Id)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.DatePayment)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.FullName)
                        </td>
                        <td>
                            $@Html.DisplayFor(modelItem => item.TotalMoney)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Status)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Note)
                        </td>
                        <td>
                            <a style="float:right; background-color:coral; color:white" href="@Url.Action("Purchase", "Manage", new { @Id = item.Id })" class="btn btn-default" role="button">View order</a>
                        </td>
                    </tr>
                }
            
            </table>
    
    if (ViewBag.TotalPage > 1)
    {
        var pageDisplay = (int)ViewBag.MaxPage;
        int totalPage = (int)ViewBag.TotalPage;
        int curentPage = ((int)ViewBag.Page);

        var startPageIndex = Math.Max(1, curentPage - pageDisplay / 2);
        var endPageIndex = Math.Min(totalPage, curentPage + pageDisplay / 2);
        var link = Url.Action("Order", "Manage");
        <nav>
            <ul class="pagination" style="text-align:center">
                @if (curentPage > ViewBag.First)
                {
                    <li><a href="@link&page=@ViewBag.First" title="First page"><i class="fa fa-angle-double-left"></i></a></li>
                    <li><a href="@link&page=@ViewBag.Pre" title="Previous page"><i class="fa fa-angle-left"></i></a></li>
                }
                @for (int i = startPageIndex; i <= endPageIndex; i++)
                {
                    if (curentPage == i)
                    {
                        <li><a href="@link?page=@i" class="active" title="Page @i">@i</a></li>
                    }
                    else
                    {
                        <li><a href="@link?page=@i" class="pos" title="Page @i">@i</a></li>
                    }
                }
                @if (curentPage < totalPage)
                {
                    <li><a href="@link?page=@ViewBag.Next" title="Next page"><i class="fa fa-angle-right"></i></a></li>
                    <li><a href="@link?page=@ViewBag.Last" title="Last page"><i class="fa fa-angle-double-right"></i></a></li>
                }
            </ul>
        </nav>
    }
    else
    {
        <nav>
            <ul class="pagination">
                <li><a href="@Url.Action("Order", "Manage")?page=1" class="active" title="Page 1">1</a></li>
            </ul>
        </nav>
    }
}
<style>
    .total {
        float: right
    }

    .price {
        float: right
    }

    nav ul.pagination {
        float: right;
    }

    .sta {
        margin-left: -800px;
    }
</style>



