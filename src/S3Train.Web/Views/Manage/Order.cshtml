@using S3Train.Web.Models;
@using Microsoft.AspNet.Identity;
@model HomeViewModel
@{
    ViewBag.Title = "Purchase";
    Layout = "~/Views/Shared/_Profile.cshtml";
    var ApplicationUserId = User.Identity.GetUserId();
}

@if (Model.OrderProViewModel == null || Model.OrderProViewModel.Count == 0)
{
    <div class="cart-empty">
        <p>No purchase orders yet</p>
        <a class="continue" href="@Url.Action("Index", "Home", null)">Buy Now</a>
    </div>
}
else
{

    foreach (var item in Model.OrderProViewModel)
    {
        <div class="cart-header">
            <div class="cart-sec">

                <divError executing child request class="cart-item cyc">
                    <img src="@Url.Content("~/ImagePD/" + item.ImagePath)" width="80" height="100" />
                </divError>
                <div class="cart-item-info">
                    <ul>
                        <li>@item.NameProduct</li>
                        <li>@item.BarCode</li>
                        <li>X @item.OrderQuantity</li>
                        <li class="price">$@item.Price</li>
                    </ul>
                </div>
                <div class="total">
                    <p>Total: $@item.Total</p>
                    <p><a id="btn-add-to-cart" style="float:right; background-color:coral; color:white" href="@Url.Action("Detail", "Product", new { @id = item.Id })" class="btn btn-default" role="button">Repurchase</a></p>

                </div>
                <p class="sta">Status: @item.Status</p>
                <div class="clearfix"></div>
            </div>
        </div>
    }
    if (ViewBag.TotalPage > 1)
    {
        var pageDisplay = (int)ViewBag.MaxPage;
        int totalPage = (int)ViewBag.TotalPage;
        int curentPage = ((int)ViewBag.Page);

        var startPageIndex = Math.Max(1, curentPage - pageDisplay / 2);
        var endPageIndex = Math.Min(totalPage, curentPage + pageDisplay / 2);
        var link = Url.Action("Purchase", "Manage");
        <nav>
            <ul class="pagination" style="text-align:center">
                @if (curentPage > ViewBag.First)
                    {
                    <li><a href="@link&page=@ViewBag.First" title="First page"><i class="fa fa-angle-double-left"></i></a></li>
                    <li><a href="@link&page=@ViewBag.Pre" title="Previous page"><i class="fa fa-angle-left"></i></a></li>
                }
                @for (int i = startPageIndex; i <= endPageIndex; i++)
                    {
                        if (curentPage == i)
                        {
                        <li><a href="@link?page=@i" class="active" title="Page @i">@i</a></li>
                    }
                    else
                    {
                        <li><a href="@link?page=@i" class="pos" title="Page @i">@i</a></li>
                    }
                }
                @if (curentPage < totalPage)
                    {
                    <li><a href="@link?page=@ViewBag.Next" title="Next page"><i class="fa fa-angle-right"></i></a></li>
                    <li><a href="@link?page=@ViewBag.Last" title="Last page"><i class="fa fa-angle-double-right"></i></a></li>
                }
            </ul>
        </nav>
    }
    else
    {
        <nav>
            <ul class="pagination">
                <li><a href="@Url.Action("Purchase", "Manage")?page=1" class="active" title="Page 1">1</a></li>
            </ul>
        </nav>
    }
}
<style>
    .total {
        float: right
    }

    .price {
        float: right
    }

    nav ul.pagination {
        float: right;
    }

    .sta {
        margin-left: -800px;
    }
</style>



